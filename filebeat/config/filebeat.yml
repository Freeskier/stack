filebeat.inputs:
  - input_type: log
    enabled: true
    paths:
      - /logs/arkime/*.log
      - /logs/arkime/*.json
      - /logs/suricata/suricata/*.log
      - /logs/suricata/suricata/*.json
    id: filebeat-stream
    index: 'filebeat-%{+yyyy.MM.dd}'

  - input_type: log
    enabled: true
    paths:
      - /logs/zeek/*.log
      - /logs/zeek/*.json
    id: zeek-stream
    index: 'zeek-%{+yyyy.MM.dd}'

  - input_type: log
    enabled: true
    paths:
      - /suricata/*.log
      - /suricata/*.json
    id: suricata-stream
    index: 'suricata-%{+yyyy.MM.dd}'

filebeat.modules:
  - module: zeek
    capture_loss:
      enabled: true
      var.paths: ['/zeek/capture_loss.json']
    connection:
      enabled: true
      var.paths: ['/zeek/conn.json']
    dce_rpc:
      enabled: true
      var.paths: ['/zeek/dce_rpc.json']
    dhcp:
      enabled: true
      var.paths: ['/zeek/dhcp.json']
    dnp3:
      enabled: true
      var.paths: ['/zeek/dnp3.json']
    dns:
      enabled: true
      var.paths: ['/zeek/dns.json']
    dpd:
      enabled: true
      var.paths: ['/zeek/dpd.json']
    files:
      enabled: true
      var.paths: ['/zeek/files.json']
    ftp:
      enabled: true
      var.paths: ['/zeek/ftp.json']
    http:
      enabled: true
      var.paths: ['/zeek/http.json']
    intel:
      enabled: true
      var.paths: ['/zeek/intel.json']
    irc:
      enabled: true
      var.paths: ['/zeek/irc.json']
    kerberos:
      enabled: true
      var.paths: ['/zeek/kerberos.json']
    modbus:
      enabled: true
      var.paths: ['/zeek/modbus.json']
    mysql:
      enabled: true
      var.paths: ['/zeek/mysql.json']
    notice:
      enabled: true
      var.paths: ['/zeek/notice.json']
    ntlm:
      enabled: true
      var.paths: ['/zeek/ntlm.json']
    ocsp:
      enabled: true
      var.paths: ['/zeek/ocsp.json']
    pe:
      enabled: true
      var.paths: ['/zeek/pe.json']
    radius:
      enabled: true
      var.paths: ['/zeek/radius.json']
    rdp:
      enabled: true
      var.paths: ['/zeek/rdp.json']
    rfb:
      enabled: true
      var.paths: ['/zeek/rfb.json']
    sip:
      enabled: true
      var.paths: ['/zeek/sip.json']
    smb_cmd:
      enabled: true
      var.paths: ['/zeek/smb_cmd.json']
    smb_files:
      enabled: true
      var.paths: ['/zeek/smb_files.json']
    smb_mapping:
      enabled: true
      var.paths: ['/zeek/smb_mapping.json']
    smtp:
      enabled: true
      var.paths: ['/zeek/smtp.json']
    snmp:
      enabled: true
      var.paths: ['/zeek/snmp.json']
    socks:
      enabled: true
      var.paths: ['/zeek/socks.json']
    ssh:
      enabled: true
      var.paths: ['/zeek/ssh.json']
    ssl:
      enabled: true
      var.paths: ['/zeek/ssl.json']
    stats:
      enabled: true
      var.paths: ['/zeek/stats.json']
    syslog:
      enabled: true
      var.paths: ['/zeek/syslog.json']
    traceroute:
      enabled: true
      var.paths: ['/zeek/traceroute.json']
    tunnel:
      enabled: true
      var.paths: ['/zeek/tunnel.json']
    weird:
      enabled: true
      var.paths: ['/zeek/weird.json']
    x509:
      enabled: true
      var.paths: ['/zeek/x509.json']

  - module: suricata
    eve:
      enabled: true
      var.paths: ['/suricata/eve.json']

setup.template:
  name: 'filebeat'
  pattern: 'filebeat-*'
  enabled: false

output.logstash:
  hosts: ['logstash:5088']
  ssl.certificate_authorities:
    - /usr/share/filebeat/config/certs/certificates/ca/ca.crt
  enabled: true
  ssl.certificate: '/usr/share/filebeat/config/certs/certificates/filebeat/filebeat.crt'
  ssl.key: '/usr/share/filebeat/config/certs/certificates/filebeat/filebeat.key'
